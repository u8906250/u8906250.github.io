<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />

    <title>jycatty.cc</title>
  </head>

  <body>

    <header>
      <div class="container">

        <section id="downloads">
          <a href="https://github.com/u8906250" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
    <canvas id="canvas" width="350" height="350"></canvas>
      <section id="main_content">
        <div>
          <a href="/about_cat/?timeline_path=https://dl.dropboxusercontent.com/u/41496322/cat_timeline_files/timeline.json"><img style="border-radius: 50%" src="https://dl.dropboxusercontent.com/u/41496322/cat_timeline_files//profile.png"></a>
          <a href="/about_cat/?timeline_path=https://dl.dropboxusercontent.com/u/41496322/jy_timeline_files/timeline.json"><img style="border-radius: 50%" src="https://dl.dropboxusercontent.com/u/41496322/jy_timeline_files//profile.jpg"></a>
        </div>
      </section>
      Day <span id="day">188</span>, without you.
    </div>

    
  </body>
  <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
  <script>
  	var endDate = new Date("10/16/2014");
	var nowDate = new Date();
	var day = Math.round((nowDate-endDate)/(1000*60*60*24));
	document.getElementById("day").innerHTML = day;


	var canvas = document.getElementById("canvas");
	var ctx = canvas.getContext("2d");
	var canvasOffset = $("#canvas").offset();

	var startX;
	var startY;

	var imageX = 50;
	var imageY = 50;
	var imageWidth, imageHeight, imageRight, imageBottom;
	var draggingImage = false;

	var img = new Image();
	img.onload = function () {
		imageWidth = img.width;
		imageHeight = img.height;
		imageRight = imageX + imageWidth;
		imageBottom = imageY + imageHeight;
		draw(true);
	}
	img.src = "https://dl.dropboxusercontent.com/u/41496322/cat_timeline_files//profile.png";
	
	function roundedImage(x,y,width,height,radius){
		ctx.beginPath();
		ctx.moveTo(x + radius, y);
		ctx.lineTo(x + width - radius, y);
		ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
		ctx.lineTo(x + width, y + height - radius);
		ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
		ctx.lineTo(x + radius, y + height);
		ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
		ctx.lineTo(x, y + radius);
		ctx.quadraticCurveTo(x, y, x + radius, y);
		ctx.closePath();
	}

	function draw(withBorders) {

		// clear the canvas
		ctx.clearRect(0, 0, canvas.width, canvas.height);
		// draw the image
		//roundedImage (imageX, imageY, imageWidth, imageHeight, 10);
		//ctx.clip();
		ctx.drawImage(img, 0, 0, img.width, img.height, imageX, imageY, imageWidth, imageHeight);


		// optionally draw the connecting anchor lines
	}

	function hitImage(x, y) {
		return (x > imageX && x < imageX + imageWidth && y > imageY && y < imageY + imageHeight);
	}

	function handleMouseDown(e) {
		startX = parseInt(e.clientX - canvasOffset.left);
		startY = parseInt(e.clientY - canvasOffset.top);
		draggingImage = hitImage(startX, startY);
	}
	
	function handleMouseUp(e) {
		draggingImage = false;
		draw(true);
	}

	function handleMouseOut(e) {
		handleMouseUp(e);
	}

	function handleMouseMove(e) {
		if (draggingImage) {
			imageClick = false;
			mouseX = parseInt(e.clientX - canvasOffset.left);
			mouseY = parseInt(e.clientY - canvasOffset.top);
			// move the image by the amount of the latest drag
			var dx = mouseX - startX;
			var dy = mouseY - startY;
			imageX += dx;
			imageY += dy;
			imageRight += dx;
			imageBottom += dy;
			// reset the startXY for next time
			startX = mouseX;
			startY = mouseY;

			// redraw the image with border
			draw(true);
		}
	}

	$("#canvas").mousedown(function (e) {
		handleMouseDown(e);
	});
	$("#canvas").mousemove(function (e) {
		handleMouseMove(e);
	});
	$("#canvas").mouseup(function (e) {
		handleMouseUp(e);
	});
	$("#canvas").mouseout(function (e) {
		handleMouseOut(e);
	});
  </script>
</html>
